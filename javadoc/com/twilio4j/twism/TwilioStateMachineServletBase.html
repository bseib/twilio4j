<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Fri Dec 04 11:59:37 EST 2015 -->
<title>TwilioStateMachineServletBase (Twilio4j 1.0.9 API)</title>
<meta name="date" content="2015-12-04">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="TwilioStateMachineServletBase (Twilio4j 1.0.9 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/TwilioStateMachineServletBase.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/twilio4j/twism/TwilioStateMachineServlet.TwilioHandler.html" title="interface in com.twilio4j.twism"><span class="strong">Prev Class</span></a></li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/twilio4j/twism/TwilioStateMachineServletBase.html" target="_top">Frames</a></li>
<li><a href="TwilioStateMachineServletBase.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.twilio4j.twism</div>
<h2 title="Class TwilioStateMachineServletBase" class="title">Class TwilioStateMachineServletBase</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>javax.servlet.GenericServlet</li>
<li>
<ul class="inheritance">
<li>javax.servlet.http.HttpServlet</li>
<li>
<ul class="inheritance">
<li>com.twilio4j.twism.TwilioStateMachineServletBase</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>java.io.Serializable, javax.servlet.Servlet, javax.servlet.ServletConfig</dd>
</dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../com/twilio4j/twism/TwilioStateMachineServlet.html" title="class in com.twilio4j.twism">TwilioStateMachineServlet</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="strong">TwilioStateMachineServletBase</span>
extends javax.servlet.http.HttpServlet</pre>
<div class="block"><p>
 TwilioStateMachineServletBase accepts HTTP GET and POST connections from Twilio, and advances a phone call through
 the various states of a state machine. Each possible state is represented by an enumerated type which you declare.
 The corresponding actions for each enumeration can be java code, or TwiML, or a combination of both.
 </p>
 <p>
 You will not use this class directly. You should create a subclass of TwilioStateMachineServlet to create your call
 flow state machine. You should create an enumerated type to represent all the states of your machine. Those two
 classes are the minimum needed.
 </p>
 <p>
 In twilio4j, the TwiML was designed such that it can be expressed in a declarative style, completely in Java code.
 Virtually everything is type safe, so you will know at compile time if you have well formed TwiML. You might also
 benefit from auto-completion in your IDE, speeding up the process of getting the TwiML syntax right.
 </p>
 <p>
 All "actions" and "callbacks" in the TwiML are supplied as the Enum that represents the next state. This lets your
 code just focus on the TwiML actions and the flow of the state machine. This servlet will drive the state machine,
 and take care of mapping states to URLs, and persisting user parameters into a cookie.
 </p></div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>broc.seib@gentomi.com</dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../serialized-form.html#com.twilio4j.twism.TwilioStateMachineServletBase">Serialized Form</a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../com/twilio4j/twism/TwilioStateMachineServletBase.html#TwilioStateMachineServletBase()">TwilioStateMachineServletBase</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>abstract java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../com/twilio4j/twism/TwilioStateMachineServletBase.html#advanceState(java.lang.String, com.twilio4j.twism.TwilioParameters)">advanceState</a></strong>(java.lang.String&nbsp;pathInfo,
            <a href="../../../com/twilio4j/twism/TwilioParameters.html" title="class in com.twilio4j.twism">TwilioParameters</a>&nbsp;twilioParameters)</code>
<div class="block">
 advanceState() asks the implementing class to move us into the next state of the state machine, given the path
 from the URL (which contains the Enum state), and the user parameters (the HashMap<String, String>).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>abstract java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../com/twilio4j/twism/TwilioStateMachineServletBase.html#getFortyCharacterSecret()">getFortyCharacterSecret</a></strong>()</code>
<div class="block">
 This function provides a constant which is used to digitally sign the payload of a cookie.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_javax.servlet.http.HttpServlet">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;javax.servlet.http.HttpServlet</h3>
<code>service</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_javax.servlet.GenericServlet">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;javax.servlet.GenericServlet</h3>
<code>destroy, getInitParameter, getInitParameterNames, getServletConfig, getServletContext, getServletInfo, getServletName, init, init, log, log</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="TwilioStateMachineServletBase()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>TwilioStateMachineServletBase</h4>
<pre>public&nbsp;TwilioStateMachineServletBase()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getFortyCharacterSecret()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFortyCharacterSecret</h4>
<pre>public abstract&nbsp;java.lang.String&nbsp;getFortyCharacterSecret()</pre>
<div class="block"><p>
 This function provides a constant which is used to digitally sign the payload of a cookie. Here is the
 background:
 </p>
 <p>
 A HashMap (called userParams) is persisted in a cookie after each POST or GET, for the duration of the phone
 call. Anytime Twilio makes a POST or GET, you are passed these userParams and have the opportunity to alter their
 state. This servlet will take care of writing that state back out as a cookie.
 </p>
 <p>
 The "forty character secret" doesn't have to be forty characters, but should be on that order of magnitude in
 length. How it is used is this: The userParams hash map is flattened into a string with proper escaping, etc.
 This flattened value is concatenated with the secret, and a SHA1 hash is made of it. Then the flattened user
 params and the SHA1 hash become the payload of the cookie. Whenever the cookie comes back later, the payload is
 checked to know that is was not tampered with.
 </p>
 <p>
 Without this measure, it could be possible for a rogue HTTP client to connect to an intermediate state in your
 state machine and invoke an action that you did not wish to make "public". Note, this measure does not prevent
 any rogue clients from sending you a POST or GET. It will only ensure that the userParams are ones that you
 intended to set, and that they are not forged. It is still up to you to have an initial state use a Gather to
 authorize entry into the state machine.
 </p>
 <p>
 So just return a long string that is a "random" bunch of characters.
 </p></div>
</li>
</ul>
<a name="advanceState(java.lang.String, com.twilio4j.twism.TwilioParameters)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>advanceState</h4>
<pre>public abstract&nbsp;java.lang.String&nbsp;advanceState(java.lang.String&nbsp;pathInfo,
                            <a href="../../../com/twilio4j/twism/TwilioParameters.html" title="class in com.twilio4j.twism">TwilioParameters</a>&nbsp;twilioParameters)
                                       throws javax.servlet.ServletException</pre>
<div class="block"><p>
 advanceState() asks the implementing class to move us into the next state of the state machine, given the path
 from the URL (which contains the Enum state), and the user parameters (the HashMap<String, String>). It is
 expected to return a string of TwiML which will be passed back to the Twilio client, or return null if the client
 is not to take further action (i.e. in the case of a Twilio callback function).
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pathInfo</code> - is the path from the url, everything following the servlet path.</dd><dd><code>twilioParameters</code> - is just a wrapper for the userParams, which is a HashMap<String, String>. But twilioParameters also
        carries a copy of the HttpServletRequest and HttpServletResponse, just in case the raw stuff is needed.
        You never know.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String TwiML is returned to be passed back to the Twilio client, or null may be returned if no further
         action is needed to be taken by the twilio client.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>javax.servlet.ServletException</code> - if something really bad happens.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/TwilioStateMachineServletBase.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/twilio4j/twism/TwilioStateMachineServlet.TwilioHandler.html" title="interface in com.twilio4j.twism"><span class="strong">Prev Class</span></a></li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/twilio4j/twism/TwilioStateMachineServletBase.html" target="_top">Frames</a></li>
<li><a href="TwilioStateMachineServletBase.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><i>Copyright &#169; 2015 Gentomi, Inc. All Rights Reserved.</i></small></p>
</body>
</html>
